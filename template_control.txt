#Config file for the simulation of a two-dimensional DNA origami scaffold
#featuring GOx and HRP whilst assuming O2 and ABTS to be present in excess
#making the enzymatic conversion completely dependant on the enzymes Kcat and 
#the concentration and diffusion of gluose (GOx substrate) and H2O2 (HRP substrate).
#Last edited by Sander Huisman, 26/11/2018
#Last edited by Tristan de Waard
#LAst edited by Joaquin van den Bemt 10/12/2018

define TEXTOUTPUT		#Comment out to disable writing to output file "twoDout.txt"
define GRAPHICSOUTPUT	#Comment out to disable graphics

define K_GOx_fwd 		0.000154
define K_GOx_bck 		0.00013

define K_HRP_fwd 		0.000391
define K_HRP_bck 		0.575

define K_HRP_cat 		0.0327
define K_GOx_cat 		0.641	

#################################################################
#TO BE CHANGED BY SMOLDYN MANIPULATOR (automatically unsilenced)#
#################################################################

#variable neighbour_distance = #TAG:neighbour_distance
#variable linker_len = #TAG:len_linker
#variable IED = #TAG:IED
define out_file out.txt
#define out_file #TAG:out_file
#define substrate_mol #TAG:substrate_mol
#random_seed #TAG:seed
#define #TAG:makeScaffold

dim 3
boundaries x 0 200
boundaries y 0 200
boundaries z 0 200

time_start 0
time_stop 160000
time_step 0.0000292

ifdefine GRAPHICSOUTPUT
	graphics opengl_better
	graphic_iter 1
	light 1 specular 1 1 1
	frame_thickness 1
	frame_color black
	quit_at_end yes			#Quits graphics display as soon as all substrate has reacted to product, enter no if you like
	#grid_thickness 0.5
	#grid_color gray
endif

species Gluc GOx GOx-Gluc Perox HRP HRP-Perox ABTS-

difc Gluc 	670000
difc Perox 	1710000
difc ABTS- 	440000
ifdefine makeScaffold
	difc GOx	0
	difc HRP	0
else
	difc GOx	375
	difc HRP	1.44
endif

color Gluc	 	yellow
color Perox  	green
color ABTS-  	black
color GOx	 	red
color HRP	 	blue
color GOx-Gluc  orange
color HRP-Perox brown

display_size all 	4
display_size Gluc 	1
display_size Perox  2
display_size ABTS-  3

ifdefine makeScaffold
	start_surface scaffold
		action all both reflect
		color both magenta 0.8
		panel rect +1 ((100-IED)/2) 100 100-1.5*neighbour_distance (100+IED) 3*neighbour_distance scaf
	end_surface
endif

start_surface box
	action all front jump
	thickness 1
	color both 0 0 0 0
	panel rect +0 0 0 0 200 200 left
	panel rect -0 200 0 0 200 200 right 
	panel rect +1 0 0 0 200 200 bottom
	panel rect -1 0 200 0 200 200 top 
	panel rect +2 0 0 0 200 200 back
	panel rect -2 0 0 200 200 200 front
	jump left front <-> right front
	jump bottom front <-> top front
	jump back front <-> front front
end_surface

reaction GOx_fwd GOx + Gluc -> GOx-Gluc 		K_GOx_fwd
reaction GOx_bck GOx-Gluc -> GOx + Gluc 		K_GOx_bck
product_placement GOx_bck pgemmax 				0.2

reaction HRP_fwd HRP + Perox -> HRP-Perox 		K_HRP_fwd
reaction HRP_bck HRP-Perox -> HRP + Perox 		K_HRP_bck
product_placement HRP_bck pgemmax 				0.2

reaction HRP_cat HRP-Perox -> HRP + ABTS-	 	K_HRP_cat
reaction GOx_cat GOx-Gluc -> GOx + Perox 		K_GOx_cat

mol substrate_mol Gluc u u u

ifdefine makeScaffold
	mol 1 GOx (100-(IED/2)) 100+linker_len 100-neighbour_distance
	mol 1 GOx (100-(IED/2)) 100+linker_len 100
	mol 1 GOx (100-(IED/2)) 100+linker_len 100+neighbour_distance
	mol 1 HRP (100+(IED/2)) 100+linker_len 100-neighbour_distance
	mol 1 HRP (100+(IED/2)) 100+linker_len 100
	mol 1 HRP (100+(IED/2)) 100+linker_len 100+neighbour_distance
else
	mol 3 GOx u u u
	mol 3 HRP u u u
endif

text_display time Gluc Perox ABTS-

cmd e ifmore ABTS- substrate_mol-1 stop		#stops the simulation if all substrate has reacted to product
#cmd e ifless Glu 0.1*substrate_mol	stop	#stops the simulation if less than 10% of substrate is present

ifdefine TEXTOUTPUT
	output_files simSave.txt out_file
	#output_precision 3						
	cmd B savesim simSave.txt
	cmd B molcountheader out_file
	cmd E molcount out_file
endif

end_file